<!DOCTYPE html>
<head>
    <title>Manager Page</title>
    <link rel="stylesheet" href="/css/manager.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="main-container">


        <div class="data-section">
            <input type="checkbox" id="toggle-reports" class="toggle-section">
            <label for="toggle-reports" class="section-header">
                <h2>Reports</h2>
            </label>

            <div class="reports-grid">
                <button id="reports">Reports</button>
                <button id="inventoryReport">Inventory Report</button>
                <button id="menuReport">Menu Report</button>
                <button id="employeeReport">Employee Report</button>
                <button id="salesReport">Sales Report</button>
                <button id="itemizedSalesReport">Itemized Sales Report</button>
                <button id="x-reports">X-Reports</button>
            </div>
        </div>

        <div class="data-section">
            <input type="checkbox" id="toggle-chart" class="toggle-section">
            <label for="toggle-chart" class="section-header">
                <h2>Inventory Chart</h2>
            </label>

            <div class="section-controls">
                <button id="inventoryChartRefresh" class="refresh-btn">Refresh</button>
            </div>

            <div class="data-grid">
                <canvas id="inventoryChart"></canvas>
            </div>
        </div>

        <!-- Menu Items -->
        <div class="data-section">
            <input type="checkbox" id="toggle-menu" class="toggle-section">
            <label for="toggle-menu" class="section-header">
                <h2>Menu Items</h2>
            </label>
            <div class="section-controls">
                <button class="add-btn">+</button>
                <button class="delete-btn">-</button>
                <button class="update-btn">Edit</button>
            </div>
            <div class="data-grid">
                <% menuItems.forEach(item => { %>
                    <div id="hoverTag" class="data-row" data-id="<%= item.itemid %>">
                        <div class="cell" data-column="itemname"><%= item.itemname %></div>
                        <div class="cell" data-column="itemprice"><%= item.itemprice %></div>
                        <button onClick="deleteItem('menuitems', <%= item.itemid %>)" class="hidden">DELETE</button>
                    </div>
                <% }) %>
            </div>
        </div>

        <!-- Inventory Items -->
        <div class="data-section">
            <input type="checkbox" id="toggle-inventory" class="toggle-section">
            <label for="toggle-inventory" class="section-header">
                <h2>Inventory Items</h2>
            </label>
            <div class="section-controls">
                <button class="add-btn">+</button>
                <button class="delete-btn">-</button>
                <button class="update-btn">Edit</button>
            </div>
            <div class="data-grid">
                <% inventoryItems.forEach(item => { %>
                    <div id="hoverTag" class="data-row" data-id="<%= item.inventoryid %>">
                        <div class="cell" data-column="ingredientname"><%= item.ingredientname %></div>
                        <div class="cell" data-column="ingredientquantity"><%= item.ingredientquantity %></div>
                        <button onClick="deleteItem('inventory', <%= item.inventoryid %>)" class="hidden">DELETE</button>
                    </div>
                <% }) %>
            </div>
        </div>

        <!-- Recipes Section -->
        <div class="data-section">
            <input type="checkbox" id="toggle-recipes" class="toggle-section">
            <label for="toggle-recipes" class="section-header">
                <h2>Recipes</h2>
            </label>
            
            <div class="section-controls">
                 <button class="delete-btn">-</button>
            </div>

            <div class="data-grid recipes-grid">
                <% Object.values(recipes).forEach(recipeGroup => { %>
                    <div class="recipe-card" data-itemid="<%= recipeGroup.itemid %>">
                        <div class="recipe-card-header">
                            <h3><%= recipeGroup.itemname %></h3>

                        </div>
                        <ul>
                            <% recipeGroup.ingredients.forEach(ing => { %>
                                <li class="recipe-item" data-id="<%= ing.recipeid %>" 
                                    data-inventoryid="<%= ing.inventoryid %>" 
                                    data-quantity="<%= ing.quantity %>" 
                                    data-unit="<%= ing.unit %>">

                                    <span class="recipe-text">
                                        <%= ing.ingredientname %> - <%= ing.quantity %> <%= ing.unit %>
                                    </span>
                                    <button onclick="deleteItem('recipes', <%= ing.recipeid %>)" class="hidden">
                                        âœ•
                                    </button>

                                    <button class="edit-ingredient-btn">Edit</button>
                                </li>
                            <% }) %>
                        </ul>
                        <button class="add-ingredient-btn" data-itemid="<%= recipeGroup.itemid %>" data-itemname="<%= recipeGroup.itemname %>">
                            + Add Ingredient
                        </button>
                    </div>
                <% }) %>
                
                <!-- Empty state for when no recipes exist -->
                <% if (Object.keys(recipes).length === 0) { %>
                    <div class="empty-recipes-message">
                        <p>No recipes yet. Add menu items first, then create recipes for them!</p>
                    </div>
                <% } %>
            </div>
        </div>

        <!-- Employees -->
        <div class="data-section">
            <input type="checkbox" id="toggle-employees" class="toggle-section">
            <label for="toggle-employees" class="section-header">
                <h2>Employees</h2>
            </label>
            <div class="section-controls">
                <button class="add-btn">+</button>
                <button class="delete-btn">-</button>
                <button class="update-btn">Edit</button>
            </div>
            <div class="data-grid">
                <% employees.forEach(emp => { %>
                    <div id="hoverTag" class="data-row" data-id="<%= emp.employeeid %>">
                        <div class="cell" data-column="employeename"><%= emp.employeename %></div>
                        <button onClick="deleteItem('employees', <%= emp.employeeid %>)" class="hidden">DELETE</button>
                    </div>
                <% }) %>
            </div>
        </div>

        <!-- Generic modal -->
        <div id="addModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
        
            <form id="addForm">
            
            <!-- Name field (all sections) -->
            <div class="form-field" data-section="menuitems inventory employees">
                <label>Name:</label>
                <input type="text" name="name" required>
            </div>

            <!-- Description field (menuitems only) -->
            <div class="form-field" data-section="menuitems">
                <label>Description:</label>
                <input type="text" name="description">
            </div>

            <!-- Price field (menuitems only) -->
            <div class="form-field" data-section="menuitems">
                <label>Price:</label>
                <input type="number" step="0.01" name="price">
            </div>

            <!-- Quantity field (inventory only) -->
            <div class="form-field" data-section="inventory">
                <label>Quantity:</label>
                <input type="number" step="0.01" name="ingredientquantity">
            </div>

            <!-- Unit field (inventory only) -->
            <div class="form-field" data-section="inventory">
                <label>Unit:</label>
                <input type="text" name="unit">
            </div>

            <button type="submit">Add</button>
            </form>
        </div>
        </div>

        <div id="reportsScreen" class="modal">
            <div class="modal-content">
                <span id="closeModalBtn" class="close">&times;</span>
                <h2>General Overview</h2>
                <p id="totalSales">Total Sales: </p>
                <p id="totalOrders">Total Orders: </p>
                <p id="peakHour">Peak Sales Hour: </p>
                <p id="popularDrink">Most Popular Drink: </p>
            </div>
        </div>

        <div id="inventoryScreen" class="modal">
            <div class="modal-content">
                <span id="closeInvBtn" class="close">&times;</span>
                <h2>Inventory Report</h2>

                <!-- ðŸ”¹ Date Filter Section -->
                <div class="filter-section">
                <label for="startDate">Start Date:</label>
                <input type="datetime-local" id="startDate">

                <label for="endDate">End Date:</label>
                <input type="datetime-local" id="endDate">

                <button id="generateReportBtn">Generate Report</button>
                </div>

                <!-- ðŸ”¹ Report Table -->
                <div class="table-container">
                <table id="inventoryTable">
                    <thead>
                    <tr>
                        <th>Ingredient</th>
                        <th>Quantity In Stock</th>
                        <th>Total Used</th>
                        <th>Remaining</th>
                        <th>Unit</th>
                    </tr>
                    </thead>
                    <tbody id="inventoryTableBody">
                    <!-- rows will be dynamically inserted here -->
                    </tbody>
                </table>
                </div>
            </div>
        </div>


    <script src="/js/manager-reports.js"></script>
    <script src="/js/manager-handler.js"></script>
    <script src="/js/manager-modal.js"></script>
    <script src="/js/manager-recipe-handler.js"></script>

</body>
</html>
